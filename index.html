<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ShelfAssured Demo ‚Äî Fixed Nav</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root { --sa-border: #3d342f; --sa-accent: #c62828; --sa-gold: #f9a825; }
    body { font-family: 'Inter', sans-serif; background:#f7f3f0; color:#2d231e; }
    .app-flow-container { display:flex; gap:2rem; padding:1.25rem; overflow-x:auto; scroll-behavior:smooth; }
    .app-container { flex-shrink:0; width:100%; max-width:400px; min-height:800px; background:#fcfbf9;
      position:relative; box-shadow:0 4px 12px rgba(0,0,0,.1); border-radius:1.5rem; overflow:hidden; border:4px solid var(--sa-border); }
    .screen{ display:block; width:100%; height:100%; padding:1.25rem; overflow-y:auto; }
    .taskbar{ position:sticky; bottom:0; left:0; right:0; z-index:10; background:#fff; padding:1rem; border-top-left-radius:1.5rem;
      border-top-right-radius:1.5rem; box-shadow:0 -4px 12px rgba(0,0,0,.1); }
    .job-box{ background:#fff; border-left:4px solid var(--sa-gold); }
    .job-box.red-border{ border-left-color:#c62828; }
    .loading{ border:4px solid #f3f3f3; border-top:4px solid var(--sa-accent); border-radius:50%; width:24px; height:24px; animation:spin 1s linear infinite;}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    .modal{ position:fixed; inset:0; background:rgba(0,0,0,.5); display:flex; align-items:center; justify-content:center; z-index:50;
      visibility:hidden; opacity:0; transition:visibility 0s, opacity .25s; }
    .modal.is-visible{ visibility:visible; opacity:1; }
    .qnav { position:sticky; top:0; z-index:20; background:rgba(252,251,249,.85); backdrop-filter:saturate(150%) blur(4px); }
    .qbtn { @apply px-3 py-1 rounded-full border text-xs; }
  </style>
</head>
<body class="bg-gray-200">
  <div class="app-flow-container" id="flow">
    <!-- SCREEN 1: Splash -->
    <div class="app-container" id="c1">
      <div class="screen p-8 text-center flex flex-col items-center justify-center" id="screen1">
        <div class="mb-4">
          <div class="w-24 h-24 rounded-full bg-gray-200 mx-auto flex items-center justify-center text-3xl">üè∑Ô∏è</div>
        </div>
        <h1 class="text-4xl font-extrabold text-[#424242]">Shelf<span class="text-[var(--sa-gold)]">Assured</span></h1>
        <p class="mt-4 text-lg text-gray-700">Real-time, in-store visibility for emerging brands.</p>
        <div class="mt-8 w-full space-y-3">
          <button class="w-full px-6 py-3 bg-[var(--sa-accent)] text-white font-bold rounded-full shadow hover:bg-red-800" onclick="go('screen2')">Create Account</button>
          <button class="w-full px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-full shadow hover:bg-gray-300" onclick="go('screen3')">Sign In</button>
          <button class="w-full px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-full shadow hover:bg-gray-300" onclick="go('screen8')">Client Login</button>
          <button class="w-full px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-full shadow hover:bg-gray-300" onclick="go('screen14')" aria-label="Admin Login">Admin Login</button>
        </div>
      </div>
    </div>

    <!-- SCREEN 2: Create Account -->
    <div class="app-container" id="c2">
      <div class="screen p-8" id="screen2">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Create Account</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen1')">Back to Splash</button>
            <button class="qbtn" onclick="go('screen3')">Sign In</button>
          </div>
        </div>
        <h2 class="text-2xl font-bold mt-4">READY-RESET-GROW</h2>
        <p class="text-gray-500 mb-4">Choose a method to get started.</p>
        <div class="space-y-3">
          <button class="w-full px-6 py-3 bg-white border rounded-full shadow">Sign in with Google</button>
          <button class="w-full px-6 py-3 bg-white border rounded-full shadow" onclick="go('screen11')">Continue with Email</button>
        </div>
      </div>
    </div>

    <!-- SCREEN 3: Sign In -->
    <div class="app-container" id="c3">
      <div class="screen p-8" id="screen3">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Sign In</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen1')">Splash</button>
            <button class="qbtn" onclick="go('screen2')">Create</button>
          </div>
        </div>
        <h2 class="text-2xl font-bold">Welcome Back!</h2>
        <p class="text-gray-500 mb-4">Sign in to your account.</p>
        <div class="space-y-3">
          <input class="w-full border rounded px-3 py-2" placeholder="Email" type="email">
          <input class="w-full border rounded px-3 py-2" placeholder="Password" type="password">
          <button class="w-full px-6 py-3 bg-[var(--sa-accent)] text-white font-bold rounded-full shadow" onclick="go('screen4')">Sign In</button>
        </div>
        <p class="mt-3 text-sm text-gray-500">No account? <a href="#" class="text-[var(--sa-accent)]" onclick="go('screen2')">Sign up</a></p>
      </div>
    </div>

    <!-- SCREEN 4: Shopper Dashboard -->
    <div class="app-container" id="c4">
      <div class="screen p-8" id="screen4">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex flex-wrap gap-2 items-center justify-between">
          <div class="text-xs text-gray-600 font-semibold">Shopper Dashboard</div>
          <div class="flex flex-wrap gap-2">
            <button class="qbtn" onclick="go('screen9')">My Jobs</button>
            <button class="qbtn" onclick="go('screen10')">Brands</button>
            <button class="qbtn" onclick="go('screen11')">Profile</button>
            <button class="qbtn" onclick="go('screen1')">Exit</button>
          </div>
        </div>

        <h2 class="text-2xl font-extrabold">Hello, Courtney!</h2>
        <p class="text-gray-600">Your ShelfAssured Dashboard</p>
        <div class="grid grid-cols-2 gap-3 mt-4">
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-gray-400">
            <p class="text-xs text-gray-500">Total Income</p>
            <p class="text-2xl font-bold" id="total-income">$15.00</p>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-[var(--sa-accent)]">
            <p class="text-xs text-gray-500">Current Jobs</p>
            <p class="text-2xl font-bold">4</p>
          </div>
        </div>

        <div class="mt-4">
          <div class="flex items-center justify-between mb-2">
            <h3 class="text-lg font-bold">Jobs Near You</h3>
            <button class="text-sm text-[var(--sa-accent)] border px-2 py-1 rounded">Filter</button>
          </div>

          <div id="jobs-static" class="space-y-3">
            <div class="bg-gray-200 p-2 rounded text-sm">Whole Foods Market - 10133 Louetta Rd, Houston, TX 77070</div>
            <div class="job-box p-3 rounded-xl shadow hover:shadow-lg cursor-pointer" onclick="setCurrentJob('Rambler Sparkling Water','Whole Foods Market - 10133 Louetta Rd, Houston, TX 77070',300); checkLocation('Whole Foods Market - 10133 Louetta Rd, Houston, TX 77070');">
              <p class="font-bold">Rambler Sparkling Water</p>
              <p class="text-sm text-gray-500">Take and upload 2 photos</p>
              <p class="text-sm font-semibold text-[var(--sa-gold)]">Earn $3.00</p>
            </div>
            <div class="job-box p-3 rounded-xl shadow hover:shadow-lg cursor-pointer" onclick="setCurrentJob('Neutral Milk','Whole Foods Market - 10133 Louetta Rd, Houston, TX 77070',300); checkLocation('Whole Foods Market - 10133 Louetta Rd, Houston, TX 77070');">
              <p class="font-bold">Neutral Milk</p>
              <p class="text-sm text-gray-500">Take and upload 3 photos</p>
              <p class="text-sm font-semibold text-[var(--sa-gold)]">Earn $3.00</p>
            </div>

            <div class="bg-gray-200 p-2 rounded text-sm mt-4">H‚ÄëE‚ÄëB - 20017 Bridgeland Creek Pkwy, Cypress, TX 77433</div>
            <div class="job-box red-border p-3 rounded-xl shadow hover:shadow-lg cursor-pointer" onclick="setCurrentJob('RIND Snacks','H‚ÄëE‚ÄëB - 20017 Bridgeland Creek Pkwy, Cypress, TX 77433',300); checkLocation('H‚ÄëE‚ÄëB - 20017 Bridgeland Creek Pkwy, Cypress, TX 77433');">
              <p class="font-bold">RIND Snacks</p>
              <p class="text-sm text-gray-500">Take and upload 3 photos</p>
              <p class="text-sm font-semibold text-[var(--sa-gold)]">Earn $3.00</p>
            </div>
          </div>

          <!-- Dynamic jobs published from #screen20 -->
          <div id="jobs-dynamic" class="mt-4 space-y-3"></div>
        </div>

        <div class="taskbar mt-6">
          <div class="flex justify-around text-gray-500">
            <button class="flex flex-col items-center text-[var(--sa-accent)] font-bold"><span>Dashboard</span></button>
            <button class="flex flex-col items-center hover:text-[var(--sa-accent)]" onclick="go('screen9')"><span>Jobs</span></button>
            <button class="flex flex-col items-center hover:text-[var(--sa-accent)]" onclick="go('screen10')"><span>Brands</span></button>
            <button class="flex flex-col items-center hover:text-[var(--sa-accent)]" onclick="go('screen11')"><span>Profile</span></button>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 5: Job Details -->
    <div class="app-container" id="c5">
      <div class="screen p-8" id="screen5">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Job Details</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen4')">Back to Dashboard</button>
          </div>
        </div>
        <h2 class="text-2xl font-bold" id="job-title">Rambler Sparkling Water</h2>
        <p class="text-gray-500" id="job-store">Whole Foods Market</p>
        <p class="text-xl font-bold text-[var(--sa-gold)] mt-2" id="job-payout">$3.00</p>

        <div class="mt-4">
          <h3 class="font-bold">Job Instructions</h3>
          <ul class="mt-2 space-y-2 text-sm text-gray-700">
            <li>‚úî Go to the beverage aisle.</li>
            <li>‚úî Take a photo of the shelf section (good lighting).</li>
            <li>‚úî Take a photo of the product tag (price + barcode readable).</li>
          </ul>
          <div id="job-extra-instructions" class="hidden mt-3 bg-yellow-50 border border-yellow-200 p-3 rounded text-sm">
            <p class="font-semibold">Special instructions:</p>
            <pre id="job-extra-instructions-text" class="whitespace-pre-wrap"></pre>
          </div>
        </div>

        <div class="mt-4 bg-white p-3 rounded-xl shadow border">
          <label for="price-input" class="block text-sm font-medium text-gray-700">Confirm Shelf Price</label>
          <div class="mt-1 relative">
            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">$</span>
            <input id="price-input" type="text" inputmode="decimal" pattern="\\d+(\\.\\d{1,2})?" placeholder="2.99"
              class="pl-7 pr-12 w-full border rounded px-3 py-2 focus:ring-red-500 focus:border-red-500" aria-describedby="price-help">
            <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">USD</span>
          </div>
          <p id="price-help" class="mt-1 text-xs text-gray-500">Enter the price from the shelf tag.</p>
        </div>

        <button class="mt-4 w-full px-6 py-3 bg-[var(--sa-accent)] text-white font-bold rounded-full shadow" onclick="go('screen6')">Start Job</button>
      </div>
    </div>

    <!-- SCREEN 6: Photo Capture -->
    <div class="app-container" id="c6">
      <div class="screen p-8 text-center" id="screen6">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Photo Capture</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen5')">Back</button>
          </div>
        </div>

        <div class="mx-auto w-full max-w-sm bg-white text-black p-4 rounded-lg">
          <div class="flex items-center justify-between mb-2">
            <label class="block text-sm font-medium">Photo Input Mode</label>
            <div class="text-xs">
              <button class="px-2 py-1 border rounded" id="mode-toggle" onclick="togglePhotoMode()">Use Auto Demo</button>
            </div>
          </div>
          <div class="mb-2 text-xs">
            <label class="mr-2">Demo Set:</label>
            <select id="demo-set" class="border rounded px-2 py-1" onchange="setDemoSet(this.value)">
              <option value="coffee">Peet's Coffee (default)</option>
              <option value="sparkling">Sparkling Water Shelf</option>
            </select>
          </div>
          <div id="upload-block">
            <label class="block text-sm font-medium mb-2">Upload or take a photo</label>
            <input id="photo-input" type="file" accept="image/*" capture="environment" class="block w-full text-sm">
          </div>
          <div id="photo-preview" class="mt-3 w-full h-40 bg-gray-200 rounded-md flex items-center justify-center text-gray-500">No photo selected</div>
          <button class="mt-4 w-full px-4 py-2 bg-[var(--sa-accent)] text-white font-semibold rounded-md" onclick="proceedToAnalysis()">Use This Photo</button>
          <p class="text-xs text-gray-600 mt-2">Tip: Auto Demo loads sample images for quick walkthroughs.</p>
        </div>
      </div>
    </div>

    <!-- SCREEN 7: Analysis -->
    <div class="app-container" id="c7">
      <div class="screen p-8 text-center" id="screen7">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Uploading & Analysis</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen6')">Back</button>
            <button class="qbtn" onclick="go('screen9')">My Jobs</button>
          </div>
        </div>

        <div class="loading mx-auto"></div>
        <h2 class="text-xl font-bold mt-4">Uploading &amp; Analyzing...</h2>
        <p class="text-gray-500">This will just take a moment.</p>

        <div id="vision-analysis" class="mt-4 bg-white p-4 rounded-xl shadow border text-left">
          <div class="flex items-center justify-between">
            <h3 class="font-bold text-lg">Vision Analysis (beta)</h3>
            <button id="vision-btn" onclick="runVisionAnalysis()" class="text-sm border px-3 py-1 rounded">Analyze This Photo</button>
          </div>
          <p class="text-xs text-gray-600 mt-1">Prototype-only: click <b>Analyze This Photo</b> to populate a structured summary.</p>
          <div id="vision-results" class="mt-3 text-sm text-gray-800"></div>
        </div>

        <button class="mt-4 w-full px-6 py-3 bg-[var(--sa-accent)] text-white font-bold rounded-full shadow" onclick="submitJob()">Submit for Review</button>
      </div>
    </div>

    <!-- SCREEN 8: Client Dashboard -->
    <div class="app-container" id="c8">
      <div class="screen p-8" id="screen8">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex flex-wrap gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Client Dashboard</div>
          <div class="flex flex-wrap gap-2">
            <button class="qbtn" onclick="go('screen13')">New Job</button>
            <button class="qbtn" onclick="go('screen19'); buildReportFromState(); injectReportAnalysis();">Snapshot</button>
            <button class="qbtn" onclick="go('screen1')">Exit</button>
            <button class="qbtn" onclick="go('screen14')">Admin</button>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-[#4285F4]">
            <p class="text-xs text-gray-500">Shelf Presence Score</p><p class="text-2xl font-bold">89%</p>
            <p class="text-[10px] text-gray-500">Based on Planogram, Facings & Tidiness.</p>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-[var(--sa-accent)]">
            <p class="text-xs text-gray-500">Out-of-Stock Alerts</p><p class="text-2xl font-bold">üö®</p>
            <p class="text-[10px] text-gray-500">Whole Foods, Houston</p>
          </div>
        </div>

        <div class="mt-4 bg-white p-4 rounded-xl shadow">
          <h3 class="font-bold">Recent Audits</h3>
          <div class="mt-2 grid grid-cols-3 gap-2">
            <div class="h-20 bg-gray-200 rounded"></div>
            <div class="h-20 bg-gray-200 rounded"></div>
            <div class="h-20 bg-gray-200 rounded"></div>
            <div class="h-20 bg-gray-200 rounded"></div>
            <div class="h-20 bg-gray-200 rounded"></div>
            <div class="h-20 bg-gray-200 rounded"></div>
          </div>
        </div>

        <div class="mt-4 bg-white p-4 rounded-xl shadow border-l-4 border-[#34A853]">
          <p class="text-xs text-gray-500">Latest Reported Shelf Price</p>
          <p class="text-2xl font-bold">$<span id="reported-price">‚Äî</span></p>
          <p class="text-[11px] text-gray-500"><span id="reported-price-location">Location pending</span></p>
        </div>

        <div class="mt-4 grid grid-cols-2 gap-2">
          <button class="px-4 py-3 bg-gray-800 text-white rounded-full" onclick="go('screen19'); buildReportFromState(); injectReportAnalysis();">Open Snapshot</button>
        </div>

        <div class="mt-4 bg-white p-4 rounded-xl shadow">
          <div class="flex items-center justify-between">
            <h3 class="font-bold">Jobs Map</h3>
            <button class="text-sm border px-2 py-1 rounded" onclick="toggleMapMode()">Toggle Live Map</button>
          </div>
          <div id="map-static" class="mt-2">
            <img class="w-full h-48 object-cover rounded" alt="Map" src="https://upload.wikimedia.org/wikipedia/commons/5/5c/BlankMap-World-v2.png">
            <p class="text-[11px] text-gray-500 mt-1">Static placeholder. Toggle for live map (internet required).</p>
          </div>
          <div id="map-live" class="mt-2 hidden">
            <iframe class="w-full h-48 rounded" loading="lazy" src="https://www.google.com/maps?q=Houston,+TX&output=embed"></iframe>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 9: My Jobs -->
    <div class="app-container" id="c9">
      <div class="screen p-8" id="screen9">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">My Jobs</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen4')">Dashboard</button>
          </div>
        </div>
        <div class="space-y-3 mt-2">
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-green-500">
            <p class="font-bold">Rambler Sparkling Water</p>
            <p class="text-sm text-gray-500">Completed at Whole Foods Market</p>
            <p class="text-sm font-bold text-green-600">Earned $3.00</p>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-yellow-500">
            <p class="font-bold">Neutral Milk</p>
            <p class="text-sm text-gray-500">In progress at Whole Foods Market</p>
            <p class="text-sm font-bold text-yellow-600">Estimated: $3.00</p>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-gray-400">
            <p class="font-bold">RIND Snacks</p>
            <p class="text-sm text-gray-500">Pending approval</p>
            <p class="text-sm font-bold text-gray-500">Waiting for approval</p>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 10: Brands -->
    <div class="app-container" id="c10">
      <div class="screen p-8" id="screen10">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Brands</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen4')">Dashboard</button>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="bg-white p-4 rounded-xl shadow text-center cursor-pointer" onclick="go('screen12'); setBrand('Rambler Sparkling Water', 'Texas-based sparkling water focused on sustainability.');">
            <div class="w-24 h-24 mx-auto bg-gray-200 rounded-full flex items-center justify-center">R</div>
            <p class="font-bold mt-2">Rambler Sparkling Water</p><p class="text-[var(--sa-gold)] text-sm">Save 10%</p>
          </div>
          <div class="bg-white p-4 rounded-xl shadow text-center cursor-pointer" onclick="go('screen12'); setBrand('Neutral Milk','Carbon-neutral dairy products.');">
            <div class="w-24 h-24 mx-auto bg-gray-200 rounded-full flex items-center justify-center">N</div>
            <p class="font-bold mt-2">Neutral Milk</p><p class="text-[var(--sa-gold)] text-sm">Coupon</p>
          </div>
          <div class="bg-white p-4 rounded-xl shadow text-center cursor-pointer" onclick="go('screen12'); setBrand('RIND Snacks','Upcycled fruit snacks with the peel.');">
            <div class="w-24 h-24 mx-auto bg-gray-200 rounded-full flex items-center justify-center">R</div>
            <p class="font-bold mt-2">RIND Snacks</p><p class="text-[var(--sa-gold)] text-sm">Save 15%</p>
          </div>
          <div class="bg-white p-4 rounded-xl shadow text-center cursor-pointer" onclick="go('screen12'); setBrand('Peet\\'s Coffee','Specialty coffee, hand-roasted beans.');">
            <div class="w-24 h-24 mx-auto bg-gray-200 rounded-full flex items-center justify-center">PC</div>
            <p class="font-bold mt-2">Peet's Coffee</p><p class="text-[var(--sa-gold)] text-sm">Explore</p>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 11: Profile -->
    <div class="app-container" id="c11">
      <div class="screen p-8" id="screen11">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Profile</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen4')">Dashboard</button>
          </div>
        </div>
        <div class="space-y-3">
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-gray-400">
            <p class="font-bold">Total Earnings</p><p class="text-2xl font-bold">$15.00</p>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-gray-400">
            <p class="font-bold">Jobs Completed</p><p class="text-2xl font-bold">2</p>
          </div>
          <div class="bg-white p-3 rounded-xl shadow">
            <p class="font-bold">Account</p><p class="text-sm text-gray-600">Courtney Bhenderu</p><p class="text-sm text-gray-600">courtney.bhenderu@email.com</p>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 12: Brand Bio -->
    <div class="app-container" id="c12">
      <div class="screen p-8" id="screen12">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Brand</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen10')">Back to Brands</button>
          </div>
        </div>
        <h2 class="text-2xl font-extrabold" id="brand-bio-title">Brand</h2>
        <p class="mt-2 text-gray-700" id="brand-bio-text">‚Äî</p>
      </div>
    </div>

    <!-- SCREEN 13: Create Job (tiers) -->
    <div class="app-container" id="c13">
      <div class="screen p-8" id="screen13">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Create New Job</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen8')">Client Home</button>
            <button class="qbtn" onclick="go('screen20')">Full Form</button>
          </div>
        </div>
        <div class="space-y-3 mt-2">
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-green-500"><b>Standard Check</b><p class="text-sm text-gray-500">Core photos + analysis in 48h.</p></div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-yellow-500"><b>Launch Day Bundle</b><p class="text-sm text-gray-500">Multiple stores in 24h.</p></div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-red-500"><b>Rush Audit</b><p class="text-sm text-gray-500">Urgent in 6h.</p></div>
        </div>
        <button class="mt-4 w-full px-6 py-3 bg-[var(--sa-accent)] text-white rounded-full" onclick="go('screen8')">Select Job Type</button>
      </div>
    </div>

    <!-- SCREEN 14: Admin Dashboard -->
    <div class="app-container" id="c14">
      <div class="screen p-8" id="screen14">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex flex-wrap gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Admin Dashboard</div>
          <div class="flex flex-wrap gap-2">
            <button class="qbtn" onclick="go('screen15')">Users</button>
            <button class="qbtn" onclick="go('screen16')">Jobs</button>
            <button class="qbtn" onclick="go('screen17')">Support</button>
            <button class="qbtn" onclick="go('screen20')">Create Job</button>
            <button class="qbtn" onclick="go('screen1')">Exit</button>
            <button class="qbtn" onclick="go('screen8')">Client</button>
            <button class="qbtn" onclick="go('screen4')">Shopper</button>
          </div>
        </div>
        <div class="space-y-3 mt-2">
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-gray-400 flex items-center justify-between">
            <div><p class="font-bold">New User Sign-ups</p><p class="text-sm text-gray-500">5</p></div>
            <button class="text-sm border px-3 py-1 rounded" onclick="go('screen15')">Review</button>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-[var(--sa-gold)] flex items-center justify-between">
            <div><p class="font-bold">Jobs to Approve</p><p class="text-sm text-gray-500">3</p></div>
            <button class="text-sm border px-3 py-1 rounded" onclick="go('screen16')">Review</button>
          </div>
          <div class="bg-white p-3 rounded-xl shadow border-l-4 border-[var(--sa-accent)] flex items-center justify-between">
            <div><p class="font-bold">Support Requests</p><p class="text-sm text-gray-500">1</p></div>
            <button class="text-sm border px-3 py-1 rounded" onclick="go('screen17')">View</button>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 15: Admin Users -->
    <div class="app-container" id="c15">
      <div class="screen p-8" id="screen15">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Admin ‚Ä¢ New Users</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen14')">Admin Home</button>
          </div>
        </div>
        <div class="bg-white p-4 rounded-xl shadow border-l-4 border-gray-400">
          <p class="font-bold">New User: Jane Doe</p>
          <p class="text-sm text-gray-500">Joined: Aug 28, 2025 ‚Ä¢ Houston, TX</p>
          <div class="mt-3 flex gap-2">
            <button class="px-3 py-1 bg-green-600 text-white rounded-full text-sm">Approve</button>
            <button class="px-3 py-1 bg-red-600 text-white rounded-full text-sm">Deny</button>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 16: Admin Jobs -->
    <div class="app-container" id="c16">
      <div class="screen p-8" id="screen16">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Admin ‚Ä¢ Job Submissions</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen14')">Admin Home</button>
          </div>
        </div>
        <div class="bg-white p-4 rounded-xl shadow border-l-4 border-[var(--sa-gold)]">
          <p class="font-bold">Job: Peet's Coffee</p>
          <p class="text-sm text-gray-500">User: Jane Doe | H‚ÄëE‚ÄëB, Bridgeland</p>
          <div class="mt-3 grid grid-cols-3 gap-2">
            <div class="bg-gray-200 h-28 rounded flex items-center justify-center text-xs text-gray-500">Aisle</div>
            <div class="bg-gray-200 h-28 rounded flex items-center justify-center text-xs text-gray-500">Shelf</div>
            <div class="bg-gray-200 h-28 rounded flex items-center justify-center text-xs text-gray-500">Price Tag</div>
          </div>
          <div class="mt-3 flex gap-2">
            <button class="px-3 py-1 bg-green-600 text-white rounded-full text-sm">Approve</button>
            <button class="px-3 py-1 bg-red-600 text-white rounded-full text-sm">Reject</button>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 17: Admin Support -->
    <div class="app-container" id="c17">
      <div class="screen p-8" id="screen17">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Admin ‚Ä¢ Support</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen14')">Admin Home</button>
          </div>
        </div>
        <div class="bg-white p-4 rounded-xl shadow border-l-4 border-[var(--sa-accent)]">
          <p class="font-bold">Support Request from John Doe</p>
          <p class="text-sm text-gray-500">Re: Peet's Coffee job at H‚ÄëE‚ÄëB, Bridgeland</p>
          <p class="mt-2">"My photos keep getting rejected. I can't figure out why."</p>
          <div class="mt-3 flex gap-2">
            <button class="px-3 py-1 bg-blue-600 text-white rounded-full text-sm">Reply</button>
            <button class="px-3 py-1 bg-gray-200 rounded-full text-sm">Resolve</button>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 19: Client Snapshot -->
    <div class="app-container" id="c19">
      <div class="screen p-8" id="screen19">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Client Snapshot</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen8')">Back to Client</button>
            <button class="qbtn" onclick="window.print()">Print / Save PDF</button>
          </div>
        </div>
        <div class="max-w-2xl mx-auto bg-white rounded-xl shadow p-6">
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-gray-50 p-3 rounded"><p class="text-xs text-gray-500">Brand</p><p id="report-brand" class="font-semibold">‚Äî</p></div>
            <div class="bg-gray-50 p-3 rounded"><p class="text-xs text-gray-500">Store</p><p id="report-store" class="font-semibold">‚Äî</p></div>
            <div class="bg-gray-50 p-3 rounded"><p class="text-xs text-gray-500">Reported Shelf Price</p><p id="report-price" class="font-semibold">‚Äî</p></div>
            <div class="bg-gray-50 p-3 rounded"><p class="text-xs text-gray-500">Submitted</p><p id="report-date" class="font-semibold">‚Äî</p></div>
          </div>
          <div class="mt-4">
            <p class="font-semibold mb-2">Photos</p>
            <div class="grid grid-cols-3 gap-2" id="report-photos"></div>
          </div>
          <div class="mt-4">
            <p class="font-semibold mb-2">Analysis Summary</p>
            <div id="report-analysis" class="text-sm text-gray-800 bg-gray-50 p-3 rounded">No analysis captured yet.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- SCREEN 20: Create Job (full form) -->
    <div class="app-container" id="c20">
      <div class="screen p-8" id="screen20">
        <div class="qnav -mt-4 -mx-4 px-4 py-2 flex gap-2 justify-between items-center">
          <div class="text-xs text-gray-600 font-semibold">Create New Job (Form)</div>
          <div class="flex gap-2">
            <button class="qbtn" onclick="go('screen8')">Client</button>
            <button class="qbtn" onclick="go('screen14')">Admin</button>
            <button class="qbtn" onclick="go('screen4')">Shopper</button>
          </div>
        </div>
        <div class="max-w-2xl mx-auto bg-white rounded-xl shadow p-6">
          <div class="grid grid-cols-1 gap-3">
            <div><label class="block text-sm font-medium">Product / Brand</label><input id="cj-brand" type="text" class="mt-1 w-full border rounded px-3 py-2" placeholder="Rambler Sparkling Water"></div>
            <div>
              <label class="block text-sm font-medium">Store</label>
              <input id="cj-store" list="store-options" type="text" class="mt-1 w-full border rounded px-3 py-2" placeholder="Start typing a store...">
              <datalist id="store-options">
                <option>Whole Foods Market - 10133 Louetta Rd, Houston, TX 77070</option>
                <option>H-E-B - 28520 Tomball Pkwy, Houston, TX 77070</option>
                <option>Sprouts - 22506 Tomball Pkwy, Houston, TX 77375</option>
                <option>Central Market - 3815 Westheimer Rd, Houston, TX 77027</option>
                <option>Whole Foods Market - Kensington High St, London W8 6NA, UK</option>
              </datalist>
            </div>
            <div>
              <label class="block text-sm font-medium">Job Type</label>
              <div class="mt-1 space-y-2 text-sm">
                <label class="flex items-center gap-2"><input type="radio" name="cj-type" value="standard" checked> Standard (48h)</label>
                <label class="flex items-center gap-2"><input type="radio" name="cj-type" value="launch"> Launch Day (24h)</label>
                <label class="flex items-center gap-2"><input type="radio" name="cj-type" value="rush"> Rush (6h)</label>
              </div>
            </div>
            <div>
              <label class="block text-sm font-medium">Photo Instructions</label>
              <textarea id="cj-notes" rows="4" class="mt-1 w-full border rounded px-3 py-2" placeholder="e.g., Take a clear photo of the price tag (price + barcode visible)."></textarea>
            </div>
            <div class="flex gap-3">
              <button onclick="publishJob()" class="px-4 py-2 bg-[var(--sa-accent)] text-white rounded">Publish Job</button>
              <button onclick="go('screen8')" class="px-4 py-2 border rounded">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Location Modal -->
  <div class="modal" id="location-modal">
    <div class="bg-white p-6 rounded-2xl shadow-xl w-80 text-center">
      <h3 class="text-xl font-bold mb-2">Confirm Your Location</h3>
      <p class="text-sm text-gray-600 mb-4">To start, confirm you're at the correct store.</p>
      <p id="location-modal-text" class="text-sm font-semibold text-red-500 hidden mb-4"></p>
      <div class="space-x-2">
        <button class="px-4 py-2 bg-[var(--sa-accent)] text-white rounded-full" onclick="confirmLocation()">Confirm</button>
        <button class="px-4 py-2 border rounded-full" onclick="hideModal('location-modal')">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // --------- NAV HELPERS ---------
    function go(id){
      const el = document.getElementById(id);
      if(!el){ alert('Screen not found: '+id); return; }
      // Scroll the container so that the parent .app-container comes into view
      const container = el.closest('.app-container') || el;
      container.scrollIntoView({ behavior:'smooth', block:'nearest', inline:'start' });
    }

    // --------- SIMPLE STATE ---------
    const SA = {
      earningsKey: 'sa_earnings',
      jobsKey: 'sa_jobs_completed',
      priceKey: 'sa_last_price',
      storeKey: 'sa_last_store',
      brandKey: 'sa_last_brand',
      photoKey: 'sa_last_photo',
      submittedAtKey: 'sa_last_submitted_at',
      jobsPoolKey: 'sa_jobs_pool'
    };

    function initState(){
      if(localStorage.getItem(SA.earningsKey)===null) localStorage.setItem(SA.earningsKey,'1500');
      if(localStorage.getItem(SA.jobsKey)===null) localStorage.setItem(SA.jobsKey,'2');
      syncClientUI();
      renderJobsPool();
    }
    document.addEventListener('DOMContentLoaded', initState);

    function syncClientUI(){
      const price = localStorage.getItem(SA.priceKey);
      const store = localStorage.getItem(SA.storeKey);
      const rp = document.getElementById('reported-price');
      const rpl = document.getElementById('reported-price-location');
      if(rp) rp.textContent = price ? price : '‚Äî';
      if(rpl) rpl.textContent = store ? store : 'Location pending';
    }

    // --------- JOB FLOW ---------
    let _pendingStoreForCheck = '';
    function setCurrentJob(brand, store, payoutCents){
      localStorage.setItem('sa_current_job_brand', brand||'');
      localStorage.setItem('sa_current_job_store', store||'');
      localStorage.setItem('sa_current_job_payout', String(payoutCents||300));
      updateJobDetailsUI();
    }

    function updateJobDetailsUI(){
      const brand = localStorage.getItem('sa_current_job_brand') || 'Rambler Sparkling Water';
      const store = localStorage.getItem('sa_current_job_store') || 'Whole Foods Market';
      const payout = parseInt(localStorage.getItem('sa_current_job_payout')||'300', 10);
      const notes  = localStorage.getItem('sa_current_job_notes') || '';

      const t = document.getElementById('job-title');
      const s = document.getElementById('job-store');
      const p = document.getElementById('job-payout');
      if(t) t.textContent = brand;
      if(s) s.textContent = store;
      if(p) p.textContent = '$'+(payout/100).toFixed(2);

      const box = document.getElementById('job-extra-instructions');
      const txt = document.getElementById('job-extra-instructions-text');
      if(box && txt){
        if(notes){ txt.textContent = notes; box.classList.remove('hidden'); }
        else { box.classList.add('hidden'); }
      }
    }

    function checkLocation(store){
      _pendingStoreForCheck = store || '';
      document.getElementById('location-modal-text').classList.add('hidden');
      showModal('location-modal');
    }

    function showModal(id){ document.getElementById(id).classList.add('is-visible'); }
    function hideModal(id){ document.getElementById(id).classList.remove('is-visible'); }

    function confirmLocation(){
      hideModal('location-modal');
      if(_pendingStoreForCheck){
        localStorage.setItem(SA.storeKey, _pendingStoreForCheck);
        localStorage.setItem('sa_current_job_store', _pendingStoreForCheck);
      }
      go('screen5');
      updateJobDetailsUI();
    }

    // Submit job: validate price, bump stats, sync client UI, go to My Jobs
    function submitJob(){
      const priceInput = document.getElementById('price-input');
      const val = (priceInput && priceInput.value || '').trim();
      if(!/^[0-9]+(\\.[0-9]{1,2})?$/.test(val)){ alert('Enter a valid shelf price like 2.99'); return; }
      localStorage.setItem(SA.priceKey, val);
      if(!localStorage.getItem(SA.storeKey)){
        const s = localStorage.getItem('sa_current_job_store') || 'Unknown store';
        localStorage.setItem(SA.storeKey, s);
      }
      const b = localStorage.getItem('sa_current_job_brand') || 'Rambler Sparkling Water';
      localStorage.setItem(SA.brandKey, b);
      localStorage.setItem(SA.submittedAtKey, String(Date.now()));

      const e = parseInt(localStorage.getItem(SA.earningsKey)||'0',10);
      localStorage.setItem(SA.earningsKey, String(e+300));
      const j = parseInt(localStorage.getItem(SA.jobsKey)||'0',10);
      localStorage.setItem(SA.jobsKey, String(j+1));

      syncClientUI();
      go('screen9');
    }

    // --------- Client Snapshot ---------
    function buildReportFromState(){
      const brand = localStorage.getItem(SA.brandKey) || '‚Äî';
      const store = localStorage.getItem(SA.storeKey) || '‚Äî';
      const price = localStorage.getItem(SA.priceKey) || '‚Äî';
      const when  = localStorage.getItem(SA.submittedAtKey);
      const photo = localStorage.getItem(SA.photoKey);
      const fmt   = when ? (new Date(parseInt(when,10))).toLocaleString() : '‚Äî';

      setText('report-brand', brand);
      setText('report-store', store);
      setText('report-price', price==='‚Äî' ? '‚Äî' : '$'+price);
      setText('report-date', fmt);

      const box = document.getElementById('report-photos');
      if(box){ box.innerHTML=''; if(photo){ const img=new Image(); img.src=photo; img.className='w-full h-24 object-cover rounded'; box.appendChild(img);} }
    }
    function setText(id, val){ const el=document.getElementById(id); if(el) el.textContent = val; }

    // --------- Vision Demo ---------
    function getBaseName(url){ try { return (url||'').split('/').pop().split('?')[0]; } catch(e){ return ''; } }
    function runVisionAnalysis(){
      const name = localStorage.getItem('sa_last_photo_name') || getBaseName(localStorage.getItem(SA.photoKey)||'');
      const set = (document.getElementById('demo-set')||{}).value || (name.includes('sparkling') ? 'sparkling' : 'coffee');
      const box = document.getElementById('vision-results'); if(!box) return;
      let html='';
      if(set==='sparkling'){
        html += '<div class=\\\"mb-2\\\"><b>Detected brands:</b> bubly, Rambler, Topo Chico (approx.)</div>';
        html += '<div class=\\\"mb-2\\\"><b>Shelf zones:</b> Top: Topo Chico ‚Ä¢ Middle: bubly varieties ‚Ä¢ Right: Rambler</div>';
        html += '<table class=\\\"w-full text-xs\\\"><thead><tr><th class=\\\"text-left\\\">Brand / Variety</th><th class=\\\"text-left\\\">Approx. Facings</th><th class=\\\"text-left\\\">Shelf Position</th></tr></thead><tbody>';
        const rows=[['bubly ‚Äì red','3‚Äì4','center-left, rows 3‚Äì4'],['bubly ‚Äì orange','3‚Äì4','center rows 3‚Äì4'],['bubly ‚Äì pink','3‚Äì4','center rows 3‚Äì4'],['bubly ‚Äì yellow','2','center rows 2‚Äì3'],['bubly ‚Äì green','2‚Äì3','center-left rows 2‚Äì4'],['bubly ‚Äì teal/aqua','3‚Äì4','center rows 2‚Äì5'],['Rambler ‚Äì assorted','7‚Äì9','far-right, rows 2‚Äì5'],['Topo Chico ‚Äì Lime/Tangerine','8‚Äì10','top row']];
        rows.forEach(r=>{ html += '<tr><td>'+r[0]+'</td><td>'+r[1]+'</td><td>'+r[2]+'</td></tr>'; });
        html += '</tbody></table>';
        html += '<p class=\\\"mt-2 text-xs text-gray-600\\\">Counts approximate. OCR pricing not enabled in MVP ‚Äî use manual price field.</p>';
      }else{
        html += '<div class=\\\"mb-2\\\"><b>Detected brands:</b> Peet\\'s, Tim Hortons, Caf√© Bustelo, Free Rain (approx.)</div>';
        html += '<div class=\\\"mb-2\\\">Demo summary for coffee aisle set (placeholder logic).</div>';
      }
      box.innerHTML = html;
      try{ localStorage.setItem('sa_last_analysis_html', html);}catch(e){}
    }
    function injectReportAnalysis(){
      try{
        const ana = localStorage.getItem('sa_last_analysis_html');
        const anaBox = document.getElementById('report-analysis');
        if(ana && anaBox){ anaBox.innerHTML = ana; }
      }catch(e){}
    }

    // --------- Photo input (upload vs demo) ---------
    let autoDemo=false, demoIndex=0;
    let demoPhotos=['demo_peets_closeup.jpg','demo_peets_aisle.jpg','demo_peets_shelf.jpg'];
    function setDemoSet(v){
      if(v==='sparkling') demoPhotos=['demo_sparkling_aisle.jpg'];
      else demoPhotos=['demo_peets_closeup.jpg','demo_peets_aisle.jpg','demo_peets_shelf.jpg'];
    }
    function togglePhotoMode(){
      autoDemo=!autoDemo;
      const btn=document.getElementById('mode-toggle');
      const up=document.getElementById('upload-block');
      if(btn) btn.textContent = autoDemo ? 'Use Upload Mode' : 'Use Auto Demo';
      if(up)  up.style.display = autoDemo ? 'none' : 'block';
      if(autoDemo) loadDemoPhoto(true);
    }
    function loadDemoPhoto(forceFirst){
      const preview=document.getElementById('photo-preview'); if(!preview) return;
      preview.innerHTML='';
      const img=new Image();
      const idx = forceFirst ? 0 : (demoIndex % demoPhotos.length);
      img.src = demoPhotos[idx];
      img.className='max-h-40 object-contain';
      preview.appendChild(img);
    }
    document.addEventListener('change', (e)=>{
      if(e.target && e.target.id==='photo-input' && e.target.files && e.target.files[0]){
        const reader=new FileReader();
        reader.onload=(ev)=>{
          const preview=document.getElementById('photo-preview');
          if(preview){ preview.innerHTML=''; const img=new Image(); img.src=ev.target.result; img.className='max-h-40 object-contain'; preview.appendChild(img); localStorage.setItem(SA.photoKey, img.src); }
          try{ localStorage.setItem('sa_last_photo_name', e.target.files[0].name || ''); }catch(_){}
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    });
    function proceedToAnalysis(){
      const preview=document.getElementById('photo-preview');
      if(autoDemo && preview && !preview.querySelector('img')){ loadDemoPhoto(true); }
      const img = preview ? preview.querySelector('img') : null;
      if(img){ localStorage.setItem(SA.photoKey, img.src); try{ localStorage.setItem('sa_last_photo_name', getBaseName(img.src)); }catch(_){ } }
      demoIndex++;
      go('screen7');
    }

    // --------- Map toggle ---------
    let liveMap=false;
    function toggleMapMode(){
      liveMap=!liveMap;
      const s=document.getElementById('map-static');
      const l=document.getElementById('map-live');
      if(s && l){ s.classList.toggle('hidden', liveMap); l.classList.toggle('hidden', !liveMap); }
    }

    // --------- Dynamic Jobs (Create Job -> publish) ---------
    function getJobsPool(){ try{ return JSON.parse(localStorage.getItem(SA.jobsPoolKey)||'[]'); }catch(e){ return []; } }
    function setJobsPool(arr){ try{ localStorage.setItem(SA.jobsPoolKey, JSON.stringify(arr||[])); }catch(e){} }

    function renderJobsPool(){
      const mount=document.getElementById('jobs-dynamic'); if(!mount) return;
      const jobs=getJobsPool(); mount.innerHTML=''; if(!jobs.length) return;

      // Group by store
      const groups={};
      jobs.forEach(j=>{ const key=j.store||'Other'; (groups[key]||(groups[key]=[])).push(j); });

      Object.keys(groups).forEach(store=>{
        const wrap=document.createElement('div'); wrap.className='mt-4';
        const head=document.createElement('div'); head.className='bg-gray-200 p-2 rounded text-sm inline-block'; head.textContent=store; wrap.appendChild(head);

        const list=document.createElement('div'); list.className='mt-2 space-y-3';
        groups[store].forEach(job=>{
          const card=document.createElement('div');
          card.className='job-box p-3 rounded-xl shadow hover:shadow-lg cursor-pointer';
          card.innerHTML='<p class=\"font-bold\">'+(job.brand||'New Product')+'</p>'
            +'<p class=\"text-sm text-gray-500\">Take and upload 2 photos</p>'
            +'<p class=\"text-sm font-semibold text-[var(--sa-gold)]\">Earn $'+((job.payoutCents||300)/100).toFixed(2)+'</p>';
          card.onclick=()=>{
            localStorage.setItem('sa_current_job_brand', job.brand||'');
            localStorage.setItem('sa_current_job_store', job.store||'');
            localStorage.setItem('sa_current_job_payout', String(job.payoutCents||300));
            localStorage.setItem('sa_current_job_notes', job.notes||'');
            checkLocation(job.store||'Unknown store');
          };
          list.appendChild(card);
        });
        wrap.appendChild(list);
        mount.appendChild(wrap);
      });
    }

    function publishJob(){
      const brand = (document.getElementById('cj-brand').value||'').trim();
      const store = (document.getElementById('cj-store').value||'').trim();
      const notes = (document.getElementById('cj-notes').value||'').trim();
      const type  = (document.querySelector('input[name=\"cj-type\"]:checked')||{}).value || 'standard';
      if(!brand || !store){ alert('Please fill in Product/Brand and Store.'); return; }
      let payout = 300; if(type==='launch') payout=1200; if(type==='rush') payout=600;
      const jobs=getJobsPool(); jobs.push({id:'job_'+Date.now(), brand, store, notes, type, payoutCents:payout}); setJobsPool(jobs);
      // Prime context so user can try it immediately
      localStorage.setItem('sa_current_job_brand', brand);
      localStorage.setItem('sa_current_job_store', store);
      localStorage.setItem('sa_current_job_payout', String(payout));
      localStorage.setItem('sa_current_job_notes', notes);
      go('screen4'); setTimeout(renderJobsPool, 100);
      alert('Job published! It now appears under Jobs Near You.');
    }

    // --------- Brand helper ---------
    function setBrand(title, text){
      const t=document.getElementById('brand-bio-title');
      const b=document.getElementById('brand-bio-text');
      if(t) t.textContent = title;
      if(b) b.textContent = text;
    }
  </script>
</body>
</html>

